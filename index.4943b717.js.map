{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,SAEA,MAAMC,EAAWC,SAASC,cAAc,2BAClCC,EAAQF,SAASC,cAAc,UAC/BE,EAAWH,SAASC,cAAc,aAClCG,EAAWJ,SAASC,cAAc,qBAClCI,EAAaL,SAASC,cAAc,gBACpCK,EAAQ,GACRC,EAAU,GAEhB,SAASC,IACP,MAAMC,EAA2BC,aAAaC,QAAQ,mBAEtD,OADsBC,KAAKC,MAAMJ,E,CAMnC,SAASK,EAAaC,GACpB,MACMC,EADcR,IACYO,EAAEE,OAAOC,QAAQC,IAC7CZ,EAAQa,MAAKC,GAAQA,IAASL,IAChCM,MAAM,sCAENf,EAAQgB,KAAKP,GACbN,aAAac,QAAQ,UAAWZ,KAAKa,UAAUlB,I,CAInD,SAASmB,EAAWX,GAClB,MACMC,EADcR,IACYO,EAAEE,OAAOC,QAAQC,IAC7Cb,EAAMc,MAAKC,GAAQA,IAASL,IAC9BM,MAAM,+BAENhB,EAAMiB,KAAKP,GACXN,aAAac,QAAQ,QAASZ,KAAKa,UAAUnB,I,CAIjD,SAASqB,EAAUZ,GACjB,GAAIA,EAAEa,gBAAkBb,EAAEE,OAAQ,CAChCf,EAAM2B,UAAUC,OAAO,mBACvB3B,EAAS0B,UAAUC,OAAO,mBAC1B/B,EAASgC,oBAAoB,QAASJ,GACtC3B,SAASgC,iBAAiB,UAAWC,GACrC7B,EAAS4B,iBAAiB,QAASE,GACnC/B,EAAS6B,iBAAiB,QAASG,IAyBvCC,eAA2BjB,GACzB,MAAMkB,EAAc7B,KACd8B,YACJA,EAAWC,eACXA,EAAcC,MACdA,EAAKC,UACLA,EAASC,aACTA,EAAYC,WACZA,EAAUC,WACVA,EAAUC,SACVA,GACER,EAAYlB,GACV2B,QAAe,EAAAjD,EAAAkD,aACfC,EAAc,GACpBP,EAAUQ,SAAQC,IAChBF,EAAYzB,KAAKuB,EAAO1B,MAAK+B,GAASA,EAAMhC,KAAO+B,IAAKE,KAAK,IAE/D,MAAMC,EAAS,4EACgCf,WAAqBE,yFAGjCA,mPAK0BE,EAAaY,QAC9D,2EAE+CX,0JAK5CC,qKAI0BL,kIAI1BS,EAAYO,KAAK,wLAMtBV,8IAI0D1B,kHAGFA,0DAKlEd,EAAWmD,UAAYH,EACvB,MAAMI,EAAkBzD,SAASC,cAAc,uBACzBD,SAASC,cAAc,qBAC/B+B,iBAAiB,QAASN,GACxC+B,EAAgBzB,iBAAiB,QAASlB,E,CArFxC4C,CAHW3C,EAAEE,OAAO0C,cAAczC,QAAQC,GACtCJ,EAAEE,OAAO0C,cAAczC,QAAQC,GAC/BJ,EAAEE,OAAO0C,cAAcA,cAAczC,QAAQC,G,EAKrD,SAASgB,EAAmBpB,GACtBA,EAAEa,gBAAkBb,EAAEE,QAAQiB,G,CAGpC,SAASD,EAAgBlB,GACR,WAAXA,EAAE6C,MAAmB1B,G,CAG3B,SAASA,IACPhC,EAAM2B,UAAUgC,IAAI,mBACpB1D,EAAS0B,UAAUgC,IAAI,mBACvB9D,EAASiC,iBAAiB,QAASL,GACnC3B,SAAS+B,oBAAoB,UAAWG,GACxC9B,EAAS2B,oBAAoB,QAASG,GACtC/B,EAAS4B,oBAAoB,QAASI,E,CArDxCpC,EAASiC,iBAAiB,QAASL","sources":["src/js/modal.js"],"sourcesContent":["import { getGenres } from './genres';\n\nconst cardDivs = document.querySelector('.main-section__allcards');\nconst modal = document.querySelector('.modal');\nconst overflow = document.querySelector('.overflow');\nconst closeBtn = document.querySelector('.modal__close-btn');\nconst innerModal = document.querySelector('.modal__main');\nconst queue = [];\nconst watched = [];\n\nfunction updateMoviesList() {\n  const allMoviesListFromStorage = localStorage.getItem('currentFilmList');\n  const allMoviesList = JSON.parse(allMoviesListFromStorage);\n  return allMoviesList;\n}\n\ncardDivs.addEventListener('click', showModal);\n\nfunction addToWatched(e) {\n  const currentList = updateMoviesList();\n  const clickedFilm = currentList[e.target.dataset.id];\n  if (watched.find(film => film === clickedFilm)) {\n    alert('Film already in the watched list!');\n  } else {\n    watched.push(clickedFilm);\n    localStorage.setItem('watched', JSON.stringify(watched));\n  }\n}\n\nfunction addToQueue(e) {\n  const currentList = updateMoviesList();\n  const clickedFilm = currentList[e.target.dataset.id];\n  if (queue.find(film => film === clickedFilm)) {\n    alert('Film already in the queue!');\n  } else {\n    queue.push(clickedFilm);\n    localStorage.setItem('queue', JSON.stringify(queue));\n  }\n}\n\nfunction showModal(e) {\n  if (e.currentTarget !== e.target) {\n    modal.classList.remove('visually-hidden');\n    overflow.classList.remove('visually-hidden');\n    cardDivs.removeEventListener('click', showModal);\n    document.addEventListener('keydown', closeModalonEsc);\n    closeBtn.addEventListener('click', closeModal);\n    overflow.addEventListener('click', closeModalOverflow);\n    const id = e.target.parentElement.dataset.id\n      ? e.target.parentElement.dataset.id\n      : e.target.parentElement.parentElement.dataset.id;\n    createModal(id);\n  }\n}\n\nfunction closeModalOverflow(e) {\n  if (e.currentTarget === e.target) closeModal();\n}\n\nfunction closeModalonEsc(e) {\n  if (e.code === 'Escape') closeModal();\n}\n\nfunction closeModal() {\n  modal.classList.add('visually-hidden');\n  overflow.classList.add('visually-hidden');\n  cardDivs.addEventListener('click', showModal);\n  document.removeEventListener('keydown', closeModal);\n  closeBtn.removeEventListener('click', closeModal);\n  overflow.removeEventListener('click', closeModalOverflow);\n}\n\nasync function createModal(id) {\n  const currentList = updateMoviesList();\n  const {\n    poster_path,\n    original_title,\n    title,\n    genre_ids,\n    vote_average,\n    vote_count,\n    popularity,\n    overview,\n  } = currentList[id];\n  const genres = await getGenres();\n  const finalGenres = [];\n  genre_ids.forEach(idx => {\n    finalGenres.push(genres.find(genre => genre.id === idx).name);\n  });\n  const marcup = `<div class=\"modal__img\">\n      <img src=\"https://image.tmdb.org/t/p/w500${poster_path}\" alt=\"${title}\" />\n    </div>\n    <div class=\"modal__about\">\n      <div class=\"modal__headline\">${title}</div>\n      <ul class=\"modal__list\">\n        <li class=\"modal__item\">\n          <div class=\"modal__item-first\">Vote / Votes</div>\n          <div class=\"modal__item-votes\">\n            <span class=\"modal__item-bg modal__item--accent\">${vote_average.toFixed(\n              1\n            )}</span> /\n            <span class=\"modal__item-bg modal__item--grey\">${vote_count}</span>\n          </div>\n        </li>\n        <li class=\"modal__item\">\n          <div class=\"modal__item-first\">Popularity</div>\n          <div>${popularity}</div>\n        </li>\n        <li class=\"modal__item\">\n          <div class=\"modal__item-first\">Original Title</div>\n          <div class=\"modal__item-title\">${original_title}</div>\n        </li>\n        <li class=\"modal__item\">\n          <div class=\"modal__item-first\">Genre</div>\n          <div>${finalGenres.join(', ')}</div>\n        </li>\n      </ul>\n      <div class=\"modal__about-info\">\n        <p class=\"modal__about-headline\">About</p>\n        <p class=\"modal__about-text\">\n          ${overview}\n        </p>\n      </div>\n          <div class=\"modal__buttons\">\n      <button class=\"modal__btn-watched interactive-button\" data-id=${id}>\n        add to Watched\n      </button>\n      <button class=\"modal__btn-queue interactive-button\" data-id=${id}>add to queue</button>\n    </div>\n    </div>\n\n    `;\n  innerModal.innerHTML = marcup;\n  const addToWatchedBtn = document.querySelector('.modal__btn-watched');\n  const addToQueueBtn = document.querySelector('.modal__btn-queue');\n  addToQueueBtn.addEventListener('click', addToQueue);\n  addToWatchedBtn.addEventListener('click', addToWatched);\n}\n"],"names":["$ezyJp","parcelRequire","$8a7e756c566dd1ea$var$cardDivs","document","querySelector","$8a7e756c566dd1ea$var$modal","$8a7e756c566dd1ea$var$overflow","$8a7e756c566dd1ea$var$closeBtn","$8a7e756c566dd1ea$var$innerModal","$8a7e756c566dd1ea$var$queue","$8a7e756c566dd1ea$var$watched","$8a7e756c566dd1ea$var$updateMoviesList","allMoviesListFromStorage","localStorage","getItem","JSON","parse","$8a7e756c566dd1ea$var$addToWatched","e","clickedFilm","target","dataset","id","find","film","alert","push","setItem","stringify","$8a7e756c566dd1ea$var$addToQueue","$8a7e756c566dd1ea$var$showModal","currentTarget","classList","remove","removeEventListener","addEventListener","$8a7e756c566dd1ea$var$closeModalonEsc","$8a7e756c566dd1ea$var$closeModal","$8a7e756c566dd1ea$var$closeModalOverflow","async","currentList","poster_path","original_title","title","genre_ids","vote_average","vote_count","popularity","overview","genres","getGenres","finalGenres","forEach","idx","genre","name","marcup","toFixed","join","innerHTML","addToWatchedBtn","$8a7e756c566dd1ea$var$createModal","parentElement","code","add"],"version":3,"file":"index.4943b717.js.map"}